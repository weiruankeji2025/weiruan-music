<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>å¾®è½¯éŸ³ä¹ - ç°ä»£ç½‘é¡µéŸ³ä¹æ’­æ”¾å™¨</title>

  <!-- PWA Meta Tags -->
  <meta name="description" content="Modern Web Music Player with Cloud Storage Support">
  <meta name="theme-color" content="#00f5ff">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="WeiRuan Music">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="application-name" content="WeiRuan Music">
  <meta name="msapplication-TileColor" content="#0a0a0f">
  <meta name="msapplication-TileImage" content="/img/icons/icon-144x144.png">

  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json">

  <!-- Favicon and Icons -->
  <link rel="icon" type="image/svg+xml" href="/img/logo.svg">
  <link rel="icon" type="image/png" sizes="32x32" href="/img/icons/icon-96x96.png">
  <link rel="apple-touch-icon" href="/img/icons/icon-192x192.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/img/icons/icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/img/icons/icon-192x192.png">
  <link rel="apple-touch-icon" sizes="167x167" href="/img/icons/icon-192x192.png">

  <!-- Splash Screens for iOS -->
  <link rel="apple-touch-startup-image" href="/img/icons/icon-512x512.png">

  <link rel="stylesheet" href="css/style.css">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- Splash Screen Styles -->
  <style>
    .splash-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 50%, #0a0a0f 100%);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      transition: opacity 0.5s ease, visibility 0.5s ease;
    }
    .splash-screen.hidden {
      opacity: 0;
      visibility: hidden;
    }
    .splash-logo {
      width: 120px;
      height: 120px;
      animation: pulse 2s ease-in-out infinite, float 3s ease-in-out infinite;
    }
    .splash-title {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.8rem;
      font-weight: 700;
      color: #fff;
      margin-top: 1.5rem;
      letter-spacing: 0.1em;
    }
    .splash-title .accent {
      color: #00f5ff;
      text-shadow: 0 0 20px rgba(0, 245, 255, 0.5);
    }
    .splash-loader {
      margin-top: 2rem;
      display: flex;
      gap: 8px;
    }
    .splash-loader span {
      width: 12px;
      height: 12px;
      background: linear-gradient(135deg, #00f5ff, #ff00ff);
      border-radius: 50%;
      animation: bounce 1.4s ease-in-out infinite;
    }
    .splash-loader span:nth-child(1) { animation-delay: 0s; }
    .splash-loader span:nth-child(2) { animation-delay: 0.2s; }
    .splash-loader span:nth-child(3) { animation-delay: 0.4s; }
    .splash-loader span:nth-child(4) { animation-delay: 0.6s; }
    .splash-text {
      margin-top: 1.5rem;
      font-family: 'Rajdhani', sans-serif;
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.6);
      letter-spacing: 0.05em;
    }
    .splash-version {
      position: absolute;
      bottom: 2rem;
      font-family: 'Rajdhani', sans-serif;
      font-size: 0.8rem;
      color: rgba(255, 255, 255, 0.3);
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    @keyframes bounce {
      0%, 80%, 100% { transform: scale(0); opacity: 0.5; }
      40% { transform: scale(1); opacity: 1; }
    }
    /* Glow effect around logo */
    .splash-logo-container {
      position: relative;
    }
    .splash-logo-container::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 150px;
      height: 150px;
      background: radial-gradient(circle, rgba(0, 245, 255, 0.3) 0%, transparent 70%);
      animation: glow 2s ease-in-out infinite;
    }
    @keyframes glow {
      0%, 100% { opacity: 0.5; transform: translate(-50%, -50%) scale(1); }
      50% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
    }
  </style>
</head>
<body>
  <!-- PWA Splash/Loading Screen -->
  <div class="splash-screen" id="splashScreen">
    <div class="splash-logo-container">
      <img src="/img/logo.svg" alt="WeiRuan Music" class="splash-logo">
    </div>
    <h1 class="splash-title">WEIRUAN<span class="accent">MUSIC</span></h1>
    <div class="splash-loader">
      <span></span>
      <span></span>
      <span></span>
      <span></span>
    </div>
    <p class="splash-text">Loading your music experience...</p>
    <p class="splash-version">v1.0.0</p>
  </div>

  <div class="app-container">
    <!-- Background Effects -->
    <div class="bg-effects">
      <div class="particle-container" id="particles"></div>
      <div class="grid-overlay"></div>
      <div class="glow-orb orb-1"></div>
      <div class="glow-orb orb-2"></div>
      <div class="glow-orb orb-3"></div>
    </div>

    <!-- Header -->
    <header class="header">
      <div class="logo">
        <div class="logo-icon">
          <img src="/img/logo.svg" alt="Logo" class="logo-img">
        </div>
        <span class="logo-text">WEIRUAN<span class="accent">MUSIC</span></span>
      </div>
      <nav class="nav-tabs">
        <button class="nav-tab active" data-tab="player">
          <span class="tab-icon">&#9654;</span>
          <span>æ’­æ”¾å™¨</span>
        </button>
        <button class="nav-tab" data-tab="playlist">
          <span class="tab-icon">&#9776;</span>
          <span>æ’­æ”¾åˆ—è¡¨</span>
        </button>
        <button class="nav-tab" data-tab="cloud">
          <span class="tab-icon">&#9729;</span>
          <span>äº‘å­˜å‚¨</span>
        </button>
        <button class="nav-tab" data-tab="equalizer">
          <span class="tab-icon">&#9836;</span>
          <span>å‡è¡¡å™¨</span>
        </button>
      </nav>
      <div class="header-actions">
        <button class="btn-icon" id="settingsBtn" title="è®¾ç½®">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"></circle>
            <path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path>
          </svg>
        </button>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Player Tab -->
      <section class="tab-content active" id="player-tab">
        <div class="player-wrapper">
          <!-- Visualizer -->
          <div class="visualizer-container">
            <canvas id="visualizer"></canvas>
            <div class="album-art-container">
              <div class="album-art" id="albumArt">
                <img src="/img/default-cover.svg" alt="Album Art" class="default-cover">
              </div>
              <div class="album-glow"></div>
            </div>
          </div>

          <!-- Track Info -->
          <div class="track-info">
            <h2 class="track-title" id="trackTitle">æœªé€‰æ‹©æ›²ç›®</h2>
            <p class="track-artist" id="trackArtist">é€‰æ‹©ä¸€é¦–æ­Œæ›²æ’­æ”¾</p>
            <p class="track-plays" id="trackPlays"></p>
          </div>

          <!-- Artist Info -->
          <div class="artist-info-container" id="artistInfoContainer" style="display:none"></div>

          <!-- Lyrics Panel -->
          <div class="lyrics-panel" id="lyricsPanel">
            <button class="lyrics-toggle" id="lyricsToggle" title="æ˜¾ç¤º/éšè—æ­Œè¯">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M4 6h16M4 12h16M4 18h10"/>
              </svg>
            </button>
            <div class="lyrics-content" id="lyricsContent" style="display:none">
              <div class="lyrics-text" id="lyricsText">
                <p class="lyrics-placeholder">æš‚æ— æ­Œè¯</p>
              </div>
            </div>
          </div>

          <!-- Progress Bar -->
          <div class="progress-container">
            <span class="time current" id="currentTime">0:00</span>
            <div class="progress-bar" id="progressBar">
              <div class="progress-track">
                <div class="progress-fill" id="progressFill"></div>
                <div class="progress-handle" id="progressHandle"></div>
              </div>
            </div>
            <span class="time duration" id="duration">0:00</span>
          </div>

          <!-- Controls -->
          <div class="controls">
            <div class="control-group secondary">
              <button class="btn-control mode-btn" id="shuffleBtn" title="éšæœºæ’­æ”¾">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M16 3h5v5M4 20L21 3M21 16v5h-5M15 15l6 6M4 4l5 5"/>
                </svg>
                <span class="mode-label">éšæœº</span>
              </button>
            </div>

            <div class="control-group primary">
              <button class="btn-control" id="prevBtn" title="ä¸Šä¸€æ›²">
                <svg viewBox="0 0 24 24" fill="currentColor">
                  <path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"/>
                </svg>
              </button>
              <button class="btn-control play-btn" id="playBtn" title="æ’­æ”¾">
                <svg viewBox="0 0 24 24" fill="currentColor" class="play-icon">
                  <path d="M8 5v14l11-7z"/>
                </svg>
                <svg viewBox="0 0 24 24" fill="currentColor" class="pause-icon" style="display:none">
                  <path d="M6 4h4v16H6zM14 4h4v16h-4z"/>
                </svg>
              </button>
              <button class="btn-control" id="nextBtn" title="ä¸‹ä¸€æ›²">
                <svg viewBox="0 0 24 24" fill="currentColor">
                  <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/>
                </svg>
              </button>
            </div>

            <div class="control-group secondary">
              <button class="btn-control mode-btn" id="repeatBtn" title="å¾ªç¯æ¨¡å¼">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="repeat-all">
                  <path d="M17 1l4 4-4 4"/>
                  <path d="M3 11V9a4 4 0 0 1 4-4h14"/>
                  <path d="M7 23l-4-4 4-4"/>
                  <path d="M21 13v2a4 4 0 0 1-4 4H3"/>
                </svg>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="repeat-one" style="display:none">
                  <path d="M17 1l4 4-4 4"/>
                  <path d="M3 11V9a4 4 0 0 1 4-4h14"/>
                  <path d="M7 23l-4-4 4-4"/>
                  <path d="M21 13v2a4 4 0 0 1-4 4H3"/>
                  <text x="12" y="14" text-anchor="middle" font-size="8" fill="currentColor">1</text>
                </svg>
                <span class="mode-label" id="repeatLabel">é¡ºåº</span>
              </button>
            </div>
          </div>

          <!-- æ’­æ”¾æ¨¡å¼æŒ‡ç¤ºå™¨ -->
          <div class="play-mode-indicator" id="playModeIndicator">
            <span id="playModeText">é¡ºåºæ’­æ”¾</span>
          </div>

          <!-- Volume Control -->
          <div class="volume-container">
            <button class="btn-icon volume-icon" id="volumeBtn">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="volume-high">
                <path d="M11 5L6 9H2v6h4l5 4V5z"/>
                <path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"/>
              </svg>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="volume-mute" style="display:none">
                <path d="M11 5L6 9H2v6h4l5 4V5z"/>
                <line x1="23" y1="9" x2="17" y2="15"/>
                <line x1="17" y1="9" x2="23" y2="15"/>
              </svg>
            </button>
            <div class="volume-slider">
              <input type="range" id="volumeSlider" min="0" max="100" value="80">
              <div class="volume-fill" id="volumeFill"></div>
            </div>
            <span class="volume-value" id="volumeValue">80%</span>
          </div>
        </div>
      </section>

      <!-- Playlist Tab -->
      <section class="tab-content" id="playlist-tab">
        <div class="playlist-wrapper">
          <div class="playlist-header">
            <h2>æ’­æ”¾åˆ—è¡¨</h2>
            <div class="playlist-actions">
              <label class="btn-primary upload-btn" id="uploadBtn">
                <input type="file" id="fileInput" multiple accept="audio/*" hidden>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                  <polyline points="17 8 12 3 7 8"/>
                  <line x1="12" y1="3" x2="12" y2="15"/>
                </svg>
                <span>ä¸Šä¼ éŸ³ä¹</span>
              </label>
              <button class="btn-secondary" id="clearPlaylistBtn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="3 6 5 6 21 6"/>
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                </svg>
                <span>æ¸…ç©ºåˆ—è¡¨</span>
              </button>
            </div>
          </div>
          <!-- ä¸Šä¼ è¿›åº¦æ¡ -->
          <div class="upload-progress-container" id="uploadProgressContainer" style="display: none;">
            <div class="upload-progress-info">
              <span id="uploadProgressText">æ­£åœ¨ä¸Šä¼ ...</span>
              <span id="uploadProgressPercent">0%</span>
            </div>
            <div class="upload-progress-bar">
              <div class="upload-progress-fill" id="uploadProgressFill"></div>
            </div>
          </div>
          <div class="playlist-stats">
            <span id="trackCount">0 é¦–æ›²ç›®</span>
            <span id="totalDuration">æ€»æ—¶é•¿ 0:00</span>
          </div>
          <div class="playlist-container" id="playlistContainer">
            <div class="empty-playlist">
              <div class="empty-icon">
                <svg viewBox="0 0 100 100">
                  <circle cx="50" cy="50" r="45" fill="none" stroke="currentColor" stroke-width="2" opacity="0.3"/>
                  <path d="M30 35 L30 65 L50 50 Z" fill="currentColor" opacity="0.3"/>
                  <path d="M55 35 L55 65 L75 50 Z" fill="currentColor" opacity="0.3"/>
                </svg>
              </div>
              <p>æ’­æ”¾åˆ—è¡¨ä¸ºç©º</p>
              <span>ä¸Šä¼ éŸ³ä¹æˆ–è¿æ¥äº‘å­˜å‚¨</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Cloud Tab -->
      <section class="tab-content" id="cloud-tab">
        <div class="cloud-wrapper">
          <!-- Cloud Type Selector -->
          <div class="cloud-type-selector">
            <button class="cloud-type-btn active" data-type="local">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
              </svg>
              <span>æœ¬åœ°æ‰«æ</span>
            </button>
            <button class="cloud-type-btn" data-type="webdav">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"/>
              </svg>
              <span>WebDAV</span>
            </button>
            <button class="cloud-type-btn" data-type="gdrive">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2L2 19.5h7.5L12 14l2.5 5.5H22L12 2zm0 5l5.5 9.5h-11L12 7z"/>
              </svg>
              <span>Google</span>
            </button>
            <button class="cloud-type-btn" data-type="onedrive">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M10.5 18H4a4 4 0 01-.93-7.89A6.002 6.002 0 0114.5 8.5a4.5 4.5 0 014.5 4.5c0 .5-.08 1-.23 1.45A3.5 3.5 0 0118 21h-7.5v-3z"/>
              </svg>
              <span>OneDrive</span>
            </button>
            <button class="cloud-type-btn" data-type="dropbox">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2l-7 4.5 5 3.5-5 3.5 7 4.5 7-4.5-5-3.5 5-3.5-7-4.5zm-5 14l5 3 5-3-5-3-5 3z"/>
              </svg>
              <span>Dropbox</span>
            </button>
            <button class="cloud-type-btn" data-type="aliyun">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
              </svg>
              <span>é˜¿é‡Œäº‘ç›˜</span>
            </button>
            <button class="cloud-type-btn" data-type="baidu">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M5.927 12.497c2.063-.443 1.782-2.909 1.72-3.448-.101-.83-1.078-2.282-2.405-2.167-1.67.15-1.913 2.561-1.913 2.561-.226 1.115.54 3.497 2.598 3.054zm2.19 4.288c-.06.173-.195.616-.078 1.002.23.744.204 1.463.166 1.71-.064.386-.133.468-.164.468-.055 0-.292-.035-.441-.348-.183-.378-.207-.904-.09-1.443.069-.318.198-.758.437-1.147.247-.404.544-.77.876-1.07.116-.105.222-.201.321-.286.29-.25.504-.404.566-.477.086-.104.106-.222-.063-.398-.276-.284-.502-.459-.627-.625-.126-.166-.237-.36-.325-.635-.156-.487-.094-.876.094-1.22.37-.679 1.188-.98 1.808-.99.62-.008 1.313.233 1.786.657.476.427.68 1.03.505 1.6-.132.432-.478.897-.92 1.258-.248.2-.5.363-.727.477-.378.19-.652.283-.838.319-.154.03-.374.072-.616.072s-.485-.053-.638-.19c-.064-.058-.154-.2-.126-.383.022-.147.11-.257.2-.339.084-.078.185-.136.288-.179.217-.09.455-.119.665-.091.203.027.464.13.716.286.155.097.301.205.433.318.15.13.275.257.368.367.032.038.063.077.093.117.026.033.05.067.071.1.055.09.09.174.1.238.013.096-.028.166-.08.208-.072.058-.148.074-.244.08-.15.01-.332-.025-.493-.113-.125-.067-.241-.172-.326-.322-.054-.095-.087-.18-.106-.255-.03-.12-.03-.206-.025-.264-.054.07-.128.188-.185.344z"/>
              </svg>
              <span>ç™¾åº¦ç½‘ç›˜</span>
            </button>
            <button class="cloud-type-btn" data-type="alist">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
              </svg>
              <span>Alist</span>
            </button>
            <button class="cloud-type-btn" data-type="quark">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/>
              </svg>
              <span>å¤¸å…‹ç½‘ç›˜</span>
            </button>
          </div>

          <!-- Local Scan Section -->
          <div class="cloud-section" id="local-section">
            <div class="cloud-connect">
              <h2>æœ¬åœ°éŸ³ä¹æ‰«æ</h2>
              <p class="cloud-description">æ‰«ææœåŠ¡å™¨æœ¬åœ°ç›®å½•ä¸­çš„éŸ³ä¹æ–‡ä»¶</p>
              <div id="localConfig">
                <form class="connect-form" id="localScanForm">
                  <div class="form-group">
                    <label>æ‰«æç›®å½•è·¯å¾„</label>
                    <input type="text" id="localScanPath" placeholder="/home/user/Music æˆ– D:\Music" required>
                  </div>
                  <div class="form-group">
                    <label class="checkbox-label">
                      <input type="checkbox" id="localScanRecursive" checked>
                      <span>é€’å½’æ‰«æå­ç›®å½•</span>
                    </label>
                  </div>
                  <button type="submit" class="btn-primary full-width">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/>
                    </svg>
                    <span>å¼€å§‹æ‰«æ</span>
                  </button>
                </form>
                <div class="scan-result" id="scanResult" style="display:none">
                  <div class="scan-info">
                    <span id="scanStatus">æ‰«æä¸­...</span>
                    <span id="scanCount">0 é¦–</span>
                  </div>
                  <div class="scan-progress">
                    <div class="scan-progress-bar" id="scanProgressBar"></div>
                  </div>
                </div>
                <div class="config-help">
                  <details>
                    <summary>ä½¿ç”¨è¯´æ˜</summary>
                    <ol>
                      <li>è¾“å…¥æœåŠ¡å™¨ä¸Šçš„éŸ³ä¹æ–‡ä»¶å¤¹è·¯å¾„</li>
                      <li>æ”¯æŒçš„æ ¼å¼ï¼šMP3ã€WAVã€FLACã€OGGã€M4Aã€AACã€WMA</li>
                      <li>æ‰«æç»“æœå°†æ·»åŠ åˆ°æ’­æ”¾åˆ—è¡¨</li>
                      <li>å·²æ·»åŠ çš„æ–‡ä»¶ä¸ä¼šé‡å¤æ·»åŠ </li>
                    </ol>
                  </details>
                </div>
              </div>
            </div>
            <div class="cloud-browser" id="localBrowser" style="display:none">
              <div class="browser-header">
                <button class="btn-icon" id="localBackBtn" title="è¿”å›">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
                </button>
                <div class="current-path" id="localPath">/</div>
                <button class="btn-secondary" id="localRescan">é‡æ–°æ‰«æ</button>
              </div>
              <div class="file-list" id="localFileList"></div>
            </div>
          </div>

          <!-- WebDAV Section -->
          <div class="cloud-section" id="webdav-section" style="display:none">
            <div class="cloud-connect">
              <h2>WebDAV å­˜å‚¨</h2>
              <p class="cloud-description">è¿æ¥åˆ° Nextcloudã€ownCloudã€åšæœäº‘æˆ–ä»»ä½•æ”¯æŒ WebDAV çš„å­˜å‚¨</p>
              <form class="connect-form" id="webdavForm">
                <div class="form-group">
                  <label for="webdavUrl">WebDAV åœ°å€</label>
                  <input type="url" id="webdavUrl" placeholder="https://dav.jianguoyun.com/dav/" required>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label for="webdavUser">ç”¨æˆ·å</label>
                    <input type="text" id="webdavUser" placeholder="ç”¨æˆ·å" required>
                  </div>
                  <div class="form-group">
                    <label for="webdavPass">å¯†ç /åº”ç”¨å¯†ç </label>
                    <input type="password" id="webdavPass" placeholder="å¯†ç " required>
                  </div>
                </div>
                <button type="submit" class="btn-primary full-width">
                  <span>è¿æ¥</span>
                </button>
              </form>
            </div>
            <div class="cloud-browser" id="webdavBrowser" style="display:none">
              <div class="browser-header">
                <button class="btn-icon" id="webdavBackBtn" title="è¿”å›">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                  </svg>
                </button>
                <div class="current-path" id="webdavPath">/</div>
                <button class="btn-secondary" id="webdavDisconnect">æ–­å¼€è¿æ¥</button>
              </div>
              <div class="file-list" id="webdavFileList"></div>
            </div>
          </div>

          <!-- Google Drive Section -->
          <div class="cloud-section" id="gdrive-section" style="display:none">
            <div class="cloud-connect">
              <h2>Google äº‘ç›˜</h2>
              <p class="cloud-description">è¿æ¥æ‚¨çš„ Google äº‘ç›˜è´¦æˆ·</p>
              <div class="gdrive-config" id="gdriveConfig">
                <div class="config-notice">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/>
                  </svg>
                  <span>é¦–å…ˆé…ç½® Google OAuth å‡­è¯</span>
                </div>
                <form class="connect-form" id="gdriveConfigForm">
                  <div class="form-group">
                    <label>å®¢æˆ·ç«¯ ID</label>
                    <input type="text" id="gdriveClientId" placeholder="xxx.apps.googleusercontent.com" required>
                  </div>
                  <div class="form-group">
                    <label>å®¢æˆ·ç«¯å¯†é’¥</label>
                    <input type="password" id="gdriveClientSecret" placeholder="å®¢æˆ·ç«¯å¯†é’¥" required>
                  </div>
                  <button type="submit" class="btn-primary full-width">ä¿å­˜é…ç½®</button>
                </form>
                <div class="config-help">
                  <details>
                    <summary>å¦‚ä½•è·å–å‡­è¯ï¼Ÿ</summary>
                    <ol>
                      <li>è®¿é—® <a href="https://console.cloud.google.com/" target="_blank">Google Cloud Console</a></li>
                      <li>åˆ›å»ºé¡¹ç›®å¹¶å¯ç”¨ Google Drive API</li>
                      <li>åˆ›å»º OAuth å®¢æˆ·ç«¯ ID</li>
                      <li>æ·»åŠ é‡å®šå‘ URI: <code id="gdriveRedirectUri"></code></li>
                    </ol>
                  </details>
                </div>
              </div>
              <div class="gdrive-connect" id="gdriveConnect" style="display:none">
                <button class="btn-google" id="gdriveSignInBtn">
                  <svg width="20" height="20" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>
                  <span>ä½¿ç”¨ Google ç™»å½•</span>
                </button>
                <button class="btn-secondary full-width" id="gdriveReconfigure" style="margin-top:1rem">æ›´æ”¹é…ç½®</button>
              </div>
            </div>
            <div class="cloud-browser" id="gdriveBrowser" style="display:none">
              <div class="browser-header">
                <button class="btn-icon" id="gdriveBackBtn" title="è¿”å›">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
                </button>
                <div class="gdrive-user" id="gdriveUser"><span id="gdriveEmail">-</span></div>
                <button class="btn-secondary" id="gdriveDisconnect">æ–­å¼€è¿æ¥</button>
              </div>
              <div class="file-list" id="gdriveFileList"></div>
            </div>
          </div>

          <!-- OneDrive Section -->
          <div class="cloud-section" id="onedrive-section" style="display:none">
            <div class="cloud-connect">
              <h2>OneDrive</h2>
              <p class="cloud-description">è¿æ¥æ‚¨çš„ Microsoft OneDrive è´¦æˆ·</p>
              <div id="onedriveConfig">
                <form class="connect-form" id="onedriveConfigForm">
                  <div class="form-group">
                    <label>åº”ç”¨ç¨‹åº ID (å®¢æˆ·ç«¯ ID)</label>
                    <input type="text" id="onedriveClientId" placeholder="Azure AD åº”ç”¨ ID" required>
                  </div>
                  <div class="form-group">
                    <label>å®¢æˆ·ç«¯å¯†é’¥</label>
                    <input type="password" id="onedriveClientSecret" placeholder="å®¢æˆ·ç«¯å¯†é’¥" required>
                  </div>
                  <button type="submit" class="btn-primary full-width">ä¿å­˜é…ç½®</button>
                </form>
                <div class="config-help">
                  <details>
                    <summary>å¦‚ä½•è·å–å‡­è¯ï¼Ÿ</summary>
                    <ol>
                      <li>è®¿é—® <a href="https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade" target="_blank">Azure åº”ç”¨æ³¨å†Œ</a></li>
                      <li>åˆ›å»ºæ–°åº”ç”¨å¹¶è·å–åº”ç”¨ç¨‹åº ID</li>
                      <li>æ·»åŠ é‡å®šå‘ URI: <code id="onedriveRedirectUri"></code></li>
                    </ol>
                  </details>
                </div>
              </div>
              <div id="onedriveConnect" style="display:none">
                <button class="btn-primary full-width" id="onedriveSignInBtn">ç™»å½• OneDrive</button>
                <button class="btn-secondary full-width" id="onedriveReconfigure" style="margin-top:1rem">æ›´æ”¹é…ç½®</button>
              </div>
            </div>
            <div class="cloud-browser" id="onedriveBrowser" style="display:none">
              <div class="browser-header">
                <button class="btn-icon" id="onedriveBackBtn" title="è¿”å›">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
                </button>
                <div id="onedriveUser"><span id="onedriveEmail">-</span></div>
                <button class="btn-secondary" id="onedriveDisconnect">æ–­å¼€è¿æ¥</button>
              </div>
              <div class="file-list" id="onedriveFileList"></div>
            </div>
          </div>

          <!-- Dropbox Section -->
          <div class="cloud-section" id="dropbox-section" style="display:none">
            <div class="cloud-connect">
              <h2>Dropbox</h2>
              <p class="cloud-description">è¿æ¥æ‚¨çš„ Dropbox è´¦æˆ·</p>
              <div id="dropboxConfig">
                <form class="connect-form" id="dropboxConfigForm">
                  <div class="form-group">
                    <label>App Key</label>
                    <input type="text" id="dropboxClientId" placeholder="Dropbox App Key" required>
                  </div>
                  <div class="form-group">
                    <label>App Secret</label>
                    <input type="password" id="dropboxClientSecret" placeholder="Dropbox App Secret" required>
                  </div>
                  <button type="submit" class="btn-primary full-width">ä¿å­˜é…ç½®</button>
                </form>
                <div class="config-help">
                  <details>
                    <summary>å¦‚ä½•è·å–å‡­è¯ï¼Ÿ</summary>
                    <ol>
                      <li>è®¿é—® <a href="https://www.dropbox.com/developers/apps" target="_blank">Dropbox App Console</a></li>
                      <li>åˆ›å»ºåº”ç”¨å¹¶è·å– App Key/Secret</li>
                      <li>æ·»åŠ é‡å®šå‘ URI: <code id="dropboxRedirectUri"></code></li>
                    </ol>
                  </details>
                </div>
              </div>
              <div id="dropboxConnect" style="display:none">
                <button class="btn-primary full-width" id="dropboxSignInBtn">ç™»å½• Dropbox</button>
                <button class="btn-secondary full-width" id="dropboxReconfigure" style="margin-top:1rem">æ›´æ”¹é…ç½®</button>
              </div>
            </div>
            <div class="cloud-browser" id="dropboxBrowser" style="display:none">
              <div class="browser-header">
                <button class="btn-icon" id="dropboxBackBtn" title="è¿”å›">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
                </button>
                <div id="dropboxUser"><span id="dropboxEmail">-</span></div>
                <button class="btn-secondary" id="dropboxDisconnect">æ–­å¼€è¿æ¥</button>
              </div>
              <div class="file-list" id="dropboxFileList"></div>
            </div>
          </div>

          <!-- Aliyun Drive Section -->
          <div class="cloud-section" id="aliyun-section" style="display:none">
            <div class="cloud-connect">
              <h2>é˜¿é‡Œäº‘ç›˜</h2>
              <p class="cloud-description">ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œè¿æ¥é˜¿é‡Œäº‘ç›˜</p>
              <div id="aliyunConfig">
                <form class="connect-form" id="aliyunConfigForm">
                  <div class="form-group">
                    <label>Refresh Token</label>
                    <input type="text" id="aliyunRefreshToken" placeholder="é˜¿é‡Œäº‘ç›˜åˆ·æ–°ä»¤ç‰Œ" required>
                  </div>
                  <button type="submit" class="btn-primary full-width">è¿æ¥</button>
                </form>
                <div class="config-help">
                  <details>
                    <summary>å¦‚ä½•è·å–åˆ·æ–°ä»¤ç‰Œï¼Ÿ</summary>
                    <ol>
                      <li>ç™»å½•é˜¿é‡Œäº‘ç›˜ç½‘é¡µç‰ˆ</li>
                      <li>æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· (F12)</li>
                      <li>åœ¨ Application â†’ Local Storage ä¸­æ‰¾åˆ° token</li>
                      <li>å¤åˆ¶ refresh_token çš„å€¼</li>
                    </ol>
                  </details>
                </div>
              </div>
            </div>
            <div class="cloud-browser" id="aliyunBrowser" style="display:none">
              <div class="browser-header">
                <button class="btn-icon" id="aliyunBackBtn" title="è¿”å›">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
                </button>
                <div id="aliyunUser"><span id="aliyunUserName">-</span></div>
                <button class="btn-secondary" id="aliyunDisconnect">æ–­å¼€è¿æ¥</button>
              </div>
              <div class="file-list" id="aliyunFileList"></div>
            </div>
          </div>

          <!-- Baidu Pan Section -->
          <div class="cloud-section" id="baidu-section" style="display:none">
            <div class="cloud-connect">
              <h2>ç™¾åº¦ç½‘ç›˜</h2>
              <p class="cloud-description">è¿æ¥æ‚¨çš„ç™¾åº¦ç½‘ç›˜è´¦æˆ·</p>
              <div id="baiduConfig">
                <form class="connect-form" id="baiduConfigForm">
                  <div class="form-group">
                    <label>App Key</label>
                    <input type="text" id="baiduAppKey" placeholder="ç™¾åº¦å¼€æ”¾å¹³å° App Key" required>
                  </div>
                  <div class="form-group">
                    <label>Secret Key</label>
                    <input type="password" id="baiduSecretKey" placeholder="ç™¾åº¦å¼€æ”¾å¹³å° Secret Key" required>
                  </div>
                  <button type="submit" class="btn-primary full-width">ä¿å­˜é…ç½®</button>
                </form>
                <div class="config-help">
                  <details>
                    <summary>å¦‚ä½•è·å–å‡­è¯ï¼Ÿ</summary>
                    <ol>
                      <li>è®¿é—® <a href="https://pan.baidu.com/union/main/application/personal" target="_blank">ç™¾åº¦ç½‘ç›˜å¼€æ”¾å¹³å°</a></li>
                      <li>åˆ›å»ºåº”ç”¨å¹¶è·å– App Key/Secret Key</li>
                      <li>æ·»åŠ é‡å®šå‘ URI: <code id="baiduRedirectUri"></code></li>
                    </ol>
                  </details>
                </div>
              </div>
              <div id="baiduConnect" style="display:none">
                <button class="btn-primary full-width" id="baiduSignInBtn">ç™»å½•ç™¾åº¦ç½‘ç›˜</button>
                <button class="btn-secondary full-width" id="baiduReconfigure" style="margin-top:1rem">æ›´æ”¹é…ç½®</button>
              </div>
            </div>
            <div class="cloud-browser" id="baiduBrowser" style="display:none">
              <div class="browser-header">
                <button class="btn-icon" id="baiduBackBtn" title="è¿”å›">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
                </button>
                <div id="baiduUser"><span id="baiduUserName">-</span></div>
                <button class="btn-secondary" id="baiduDisconnect">æ–­å¼€è¿æ¥</button>
              </div>
              <div class="file-list" id="baiduFileList"></div>
            </div>
          </div>

          <!-- Alist Section -->
          <div class="cloud-section" id="alist-section" style="display:none">
            <div class="cloud-connect">
              <h2>Alist</h2>
              <p class="cloud-description">è¿æ¥ Alist æœåŠ¡å™¨ï¼ˆæ”¯æŒå¤šç§ç½‘ç›˜èšåˆï¼‰</p>
              <div id="alistConfig">
                <form class="connect-form" id="alistConfigForm">
                  <div class="form-group">
                    <label>Alist æœåŠ¡å™¨åœ°å€</label>
                    <input type="url" id="alistUrl" placeholder="https://your-alist-server.com" required>
                  </div>
                  <div class="form-row">
                    <div class="form-group">
                      <label>ç”¨æˆ·åï¼ˆå¯é€‰ï¼‰</label>
                      <input type="text" id="alistUser" placeholder="ç”¨æˆ·å">
                    </div>
                    <div class="form-group">
                      <label>å¯†ç ï¼ˆå¯é€‰ï¼‰</label>
                      <input type="password" id="alistPass" placeholder="å¯†ç ">
                    </div>
                  </div>
                  <button type="submit" class="btn-primary full-width">è¿æ¥</button>
                </form>
                <div class="config-help">
                  <details>
                    <summary>ä»€ä¹ˆæ˜¯ Alistï¼Ÿ</summary>
                    <p>Alist æ˜¯ä¸€ä¸ªæ”¯æŒå¤šç§å­˜å‚¨çš„æ–‡ä»¶åˆ—è¡¨ç¨‹åºï¼Œå¯ä»¥èšåˆé˜¿é‡Œäº‘ç›˜ã€ç™¾åº¦ç½‘ç›˜ã€OneDrive ç­‰å¤šç§ç½‘ç›˜ã€‚</p>
                    <ol>
                      <li>éƒ¨ç½²æˆ–ä½¿ç”¨å…¬å…± Alist æœåŠ¡</li>
                      <li>è¾“å…¥æœåŠ¡å™¨åœ°å€å³å¯è¿æ¥</li>
                      <li>å¦‚éœ€è®¿é—®ç§æœ‰ç›®å½•ï¼Œè¯·è¾“å…¥ç”¨æˆ·åå¯†ç </li>
                    </ol>
                  </details>
                </div>
              </div>
            </div>
            <div class="cloud-browser" id="alistBrowser" style="display:none">
              <div class="browser-header">
                <button class="btn-icon" id="alistBackBtn" title="è¿”å›">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
                </button>
                <div class="current-path" id="alistPath">/</div>
                <button class="btn-secondary" id="alistDisconnect">æ–­å¼€è¿æ¥</button>
              </div>
              <div class="file-list" id="alistFileList"></div>
            </div>
          </div>

          <!-- Quark Section -->
          <div class="cloud-section" id="quark-section" style="display:none">
            <div class="cloud-connect">
              <h2>å¤¸å…‹ç½‘ç›˜</h2>
              <p class="cloud-description">ä½¿ç”¨ Cookie è¿æ¥å¤¸å…‹ç½‘ç›˜</p>
              <div id="quarkConfig">
                <form class="connect-form" id="quarkConfigForm">
                  <div class="form-group">
                    <label>Cookie</label>
                    <input type="text" id="quarkCookie" placeholder="è¯·è¾“å…¥å¤¸å…‹ç½‘ç›˜ Cookie" required>
                  </div>
                  <button type="submit" class="btn-primary full-width">è¿æ¥</button>
                </form>
                <div class="config-help">
                  <details>
                    <summary>å¦‚ä½•è·å– Cookieï¼Ÿ</summary>
                    <ol>
                      <li>ç™»å½•å¤¸å…‹ç½‘ç›˜ç½‘é¡µç‰ˆ</li>
                      <li>æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· (F12)</li>
                      <li>åˆ‡æ¢åˆ° Network æ ‡ç­¾</li>
                      <li>åˆ·æ–°é¡µé¢ï¼Œæ‰¾åˆ°ä»»æ„è¯·æ±‚</li>
                      <li>å¤åˆ¶è¯·æ±‚å¤´ä¸­çš„ Cookie å€¼</li>
                    </ol>
                  </details>
                </div>
              </div>
            </div>
            <div class="cloud-browser" id="quarkBrowser" style="display:none">
              <div class="browser-header">
                <button class="btn-icon" id="quarkBackBtn" title="è¿”å›">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
                </button>
                <div class="current-path" id="quarkPath">/</div>
                <button class="btn-secondary" id="quarkDisconnect">æ–­å¼€è¿æ¥</button>
              </div>
              <div class="file-list" id="quarkFileList"></div>
            </div>
          </div>

        </div>
      </section>

      <!-- Equalizer Tab -->
      <section class="tab-content" id="equalizer-tab">
        <div class="equalizer-wrapper">
          <h2>éŸ³é¢‘å‡è¡¡å™¨</h2>
          <p class="eq-description">è‡ªå®šä¹‰æ‚¨çš„éŸ³é¢‘ä½“éªŒ</p>
          <div class="eq-presets">
            <button class="preset-btn active" data-preset="flat">å¹³å¦</button>
            <button class="preset-btn" data-preset="rock">æ‘‡æ»š</button>
            <button class="preset-btn" data-preset="pop">æµè¡Œ</button>
            <button class="preset-btn" data-preset="jazz">çˆµå£«</button>
            <button class="preset-btn" data-preset="classical">å¤å…¸</button>
            <button class="preset-btn" data-preset="electronic">ç”µå­</button>
            <button class="preset-btn" data-preset="bass">ä½éŸ³å¢å¼º</button>
            <button class="preset-btn" data-preset="vocal">äººå£°</button>
          </div>
          <div class="eq-sliders">
            <div class="eq-band"><input type="range" class="eq-slider" id="eq-32" min="-12" max="12" value="0" orient="vertical"><span class="eq-label">32Hz</span><span class="eq-value" data-for="eq-32">0dB</span></div>
            <div class="eq-band"><input type="range" class="eq-slider" id="eq-64" min="-12" max="12" value="0" orient="vertical"><span class="eq-label">64Hz</span><span class="eq-value" data-for="eq-64">0dB</span></div>
            <div class="eq-band"><input type="range" class="eq-slider" id="eq-125" min="-12" max="12" value="0" orient="vertical"><span class="eq-label">125Hz</span><span class="eq-value" data-for="eq-125">0dB</span></div>
            <div class="eq-band"><input type="range" class="eq-slider" id="eq-250" min="-12" max="12" value="0" orient="vertical"><span class="eq-label">250Hz</span><span class="eq-value" data-for="eq-250">0dB</span></div>
            <div class="eq-band"><input type="range" class="eq-slider" id="eq-500" min="-12" max="12" value="0" orient="vertical"><span class="eq-label">500Hz</span><span class="eq-value" data-for="eq-500">0dB</span></div>
            <div class="eq-band"><input type="range" class="eq-slider" id="eq-1k" min="-12" max="12" value="0" orient="vertical"><span class="eq-label">1kHz</span><span class="eq-value" data-for="eq-1k">0dB</span></div>
            <div class="eq-band"><input type="range" class="eq-slider" id="eq-2k" min="-12" max="12" value="0" orient="vertical"><span class="eq-label">2kHz</span><span class="eq-value" data-for="eq-2k">0dB</span></div>
            <div class="eq-band"><input type="range" class="eq-slider" id="eq-4k" min="-12" max="12" value="0" orient="vertical"><span class="eq-label">4kHz</span><span class="eq-value" data-for="eq-4k">0dB</span></div>
            <div class="eq-band"><input type="range" class="eq-slider" id="eq-8k" min="-12" max="12" value="0" orient="vertical"><span class="eq-label">8kHz</span><span class="eq-value" data-for="eq-8k">0dB</span></div>
            <div class="eq-band"><input type="range" class="eq-slider" id="eq-16k" min="-12" max="12" value="0" orient="vertical"><span class="eq-label">16kHz</span><span class="eq-value" data-for="eq-16k">0dB</span></div>
          </div>
          <div class="audio-effects">
            <h3>éŸ³é¢‘æ•ˆæœ</h3>
            <div class="effect-controls">
              <div class="effect-item"><span class="effect-label">ç«‹ä½“å£°å¢å¼º</span><input type="range" class="effect-slider" id="stereoWidth" min="0" max="100" value="50"><span class="effect-value" id="stereoWidthValue">50%</span></div>
              <div class="effect-item"><span class="effect-label">ä½éŸ³å¢å¼º</span><input type="range" class="effect-slider" id="bassBoost" min="0" max="100" value="0"><span class="effect-value" id="bassBoostValue">0%</span></div>
              <div class="effect-item"><span class="effect-label">æ··å“</span><input type="range" class="effect-slider" id="reverb" min="0" max="100" value="0"><span class="effect-value" id="reverbValue">0%</span></div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Mini Player -->
    <footer class="mini-player" id="miniPlayer">
      <div class="mini-track">
        <div class="mini-art" id="miniArt"></div>
        <div class="mini-info">
          <span class="mini-title" id="miniTitle">æ— æ›²ç›®</span>
          <span class="mini-artist" id="miniArtist">-</span>
        </div>
      </div>
      <div class="mini-controls">
        <button class="btn-mini" id="miniPrev"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"/></svg></button>
        <button class="btn-mini play" id="miniPlay"><svg viewBox="0 0 24 24" fill="currentColor" class="play-icon"><path d="M8 5v14l11-7z"/></svg><svg viewBox="0 0 24 24" fill="currentColor" class="pause-icon" style="display:none"><path d="M6 4h4v16H6zM14 4h4v16h-4z"/></svg></button>
        <button class="btn-mini" id="miniNext"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/></svg></button>
      </div>
      <div class="mini-progress">
        <div class="mini-progress-bar" id="miniProgressBar">
          <div class="mini-progress-fill" id="miniProgressFill"></div>
        </div>
      </div>
    </footer>
  </div>

  <!-- Settings Modal -->
  <div class="modal" id="settingsModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>è®¾ç½®</h3>
        <button class="btn-icon close-modal">&times;</button>
      </div>
      <div class="modal-body">
        <div class="setting-item"><span>ä¸»é¢˜</span><select id="themeSelect"><option value="dark">æš—é»‘æ¨¡å¼</option><option value="light">æ˜äº®æ¨¡å¼</option></select></div>
        <div class="setting-item"><span>å¯è§†åŒ–æ ·å¼</span><select id="visualizerSelect"><option value="bars">é¢‘ç‡æ¡</option><option value="wave">æ³¢å½¢</option><option value="circular">ç¯å½¢</option><option value="particles">ç²’å­</option></select></div>
        <div class="setting-item"><span>è‡ªåŠ¨æ’­æ”¾ä¸‹ä¸€æ›²</span><label class="toggle"><input type="checkbox" id="autoplayToggle" checked><span class="toggle-slider"></span></label></div>
        <div class="setting-item"><span>æ˜¾ç¤ºé€šçŸ¥</span><label class="toggle"><input type="checkbox" id="notifyToggle" checked><span class="toggle-slider"></span></label></div>
        <div class="setting-item"><span>é”®ç›˜å¿«æ·é”®</span><label class="toggle"><input type="checkbox" id="shortcutsToggle" checked><span class="toggle-slider"></span></label></div>
      </div>
      <div class="shortcuts-info">
        <h4>é”®ç›˜å¿«æ·é”®</h4>
        <div class="shortcut"><kbd>ç©ºæ ¼</kbd> æ’­æ”¾/æš‚åœ</div>
        <div class="shortcut"><kbd>â†</kbd> ä¸Šä¸€æ›²</div>
        <div class="shortcut"><kbd>â†’</kbd> ä¸‹ä¸€æ›²</div>
        <div class="shortcut"><kbd>â†‘</kbd> å¢å¤§éŸ³é‡</div>
        <div class="shortcut"><kbd>â†“</kbd> å‡å°éŸ³é‡</div>
        <div class="shortcut"><kbd>M</kbd> é™éŸ³/å–æ¶ˆé™éŸ³</div>
      </div>

      <!-- iOS åå°æ’­æ”¾æç¤º -->
      <div class="ios-tips-section" id="iosTipsSection">
        <h4>ğŸ“± iOS åå°æ’­æ”¾è¯´æ˜</h4>
        <div class="ios-tips-content">
          <p>ç”±äº iOS ç³»ç»Ÿé™åˆ¶ï¼Œç½‘é¡µéŸ³ä¹æ’­æ”¾å™¨çš„åå°æ’­æ”¾åŠŸèƒ½æœ‰ä»¥ä¸‹æ³¨æ„äº‹é¡¹ï¼š</p>
          <ul>
            <li><strong>é”å±æ§åˆ¶</strong>ï¼šé”å±åå¯ä»¥åœ¨æ§åˆ¶ä¸­å¿ƒçœ‹åˆ°æ’­æ”¾æ§åˆ¶</li>
            <li><strong>ä¿æŒæ’­æ”¾</strong>ï¼šæ’­æ”¾æ—¶è¯·å‹¿å®Œå…¨é€€å‡º Safari/PWA</li>
            <li><strong>PWA æ¨¡å¼</strong>ï¼šæ·»åŠ åˆ°ä¸»å±å¹•åä½“éªŒæ›´ä½³</li>
            <li><strong>ä½ç”µé‡æ¨¡å¼</strong>ï¼šä½ç”µé‡æ¨¡å¼å¯èƒ½ä¼šå½±å“åå°æ’­æ”¾</li>
          </ul>
          <p class="ios-tips-note">æç¤ºï¼šå¦‚éœ€ç¨³å®šçš„åå°æ’­æ”¾ï¼Œå»ºè®®ä½¿ç”¨åŸç”ŸéŸ³ä¹ App</p>
        </div>
      </div>

      <!-- æ­Œæ›²è¯†åˆ«æ‰«æ -->
      <div class="scan-section">
        <h4>ğŸ” æ­Œæ›²æ‰¹é‡è¯†åˆ«</h4>
        <p class="scan-desc">æ‰«ææ‰€æœ‰æ­Œæ›²ï¼Œè‡ªåŠ¨è¯†åˆ«æ­Œæ›²åã€æ­Œæ‰‹ã€å°é¢å’Œæ­Œè¯</p>
        <div class="scan-controls">
          <button class="btn-scan" id="startScanBtn" onclick="player.startScan()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
              <circle cx="12" cy="12" r="10"/>
              <path d="M12 6v6l4 2"/>
            </svg>
            å¼€å§‹æ‰«æ
          </button>
          <button class="btn-scan secondary" id="stopScanBtn" onclick="player.stopScan()" style="display:none">
            åœæ­¢æ‰«æ
          </button>
        </div>
        <div class="scan-progress" id="scanProgress" style="display:none">
          <div class="scan-progress-bar">
            <div class="scan-progress-fill" id="scanProgressFill"></div>
          </div>
          <div class="scan-status">
            <span id="scanStatusText">å‡†å¤‡ä¸­...</span>
            <span id="scanCount">0/0</span>
          </div>
          <div class="scan-current" id="scanCurrentFile"></div>
        </div>
        <div class="scan-results" id="scanResults" style="display:none">
          <div class="scan-summary" id="scanSummary"></div>
          <div class="scan-actions">
            <button class="btn-scan write" id="writeMetadataBtn" onclick="player.writeAllMetadata()">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                <polyline points="17 21 17 13 7 13 7 21"/>
                <polyline points="7 3 7 8 15 8"/>
              </svg>
              å†™å…¥å°é¢å’Œæ­Œè¯åˆ°æ–‡ä»¶
            </button>
          </div>
          <div class="write-progress" id="writeProgress" style="display:none">
            <div class="scan-progress-bar">
              <div class="scan-progress-fill" id="writeProgressFill"></div>
            </div>
            <div class="scan-status">
              <span id="writeStatusText">å‡†å¤‡å†™å…¥...</span>
              <span id="writeCount">0/0</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="notifications" id="notifications"></div>

  <!-- PWA Install Prompt -->
  <div class="pwa-install-prompt" id="pwaInstallPrompt" style="display:none">
    <div class="pwa-install-content">
      <img src="/img/logo.svg" alt="Logo" class="pwa-install-icon">
      <div class="pwa-install-text">
        <h3>å®‰è£… WeiRuan Music</h3>
        <p>æ·»åŠ åˆ°ä¸»å±å¹•ï¼Œéšæ—¶ç•…å¬éŸ³ä¹</p>
      </div>
      <div class="pwa-install-buttons">
        <button class="pwa-install-btn" id="pwaInstallBtn">å®‰è£…</button>
        <button class="pwa-install-dismiss" id="pwaInstallDismiss">ç¨å</button>
      </div>
    </div>
  </div>

  <script src="js/app.js"></script>

  <!-- PWA Service Worker Registration -->
  <script>
    // Hide splash screen when app is ready
    window.addEventListener('load', () => {
      // Minimum splash screen display time
      setTimeout(() => {
        const splash = document.getElementById('splashScreen');
        if (splash) {
          splash.classList.add('hidden');
          // Remove from DOM after animation
          setTimeout(() => splash.remove(), 500);
        }
      }, 1500);

      // Register Service Worker
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js')
          .then((registration) => {
            console.log('Service Worker registered:', registration.scope);

            // Check for updates
            registration.addEventListener('updatefound', () => {
              const newWorker = registration.installing;
              newWorker.addEventListener('statechange', () => {
                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                  // New version available
                  if (confirm('æ–°ç‰ˆæœ¬å¯ç”¨ï¼Œæ˜¯å¦åˆ·æ–°é¡µé¢ï¼Ÿ')) {
                    newWorker.postMessage({ action: 'skipWaiting' });
                    window.location.reload();
                  }
                }
              });
            });
          })
          .catch((error) => {
            console.error('Service Worker registration failed:', error);
          });
      }
    });

    // PWA Install Prompt
    let deferredPrompt;

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;

      // Show install prompt after a delay
      setTimeout(() => {
        const prompt = document.getElementById('pwaInstallPrompt');
        if (prompt && !localStorage.getItem('pwaInstallDismissed')) {
          prompt.style.display = 'flex';
        }
      }, 5000);
    });

    // Install button click
    document.getElementById('pwaInstallBtn')?.addEventListener('click', async () => {
      const prompt = document.getElementById('pwaInstallPrompt');
      if (prompt) prompt.style.display = 'none';

      if (deferredPrompt) {
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        console.log('PWA install outcome:', outcome);
        deferredPrompt = null;
      }
    });

    // Dismiss button click
    document.getElementById('pwaInstallDismiss')?.addEventListener('click', () => {
      const prompt = document.getElementById('pwaInstallPrompt');
      if (prompt) prompt.style.display = 'none';
      localStorage.setItem('pwaInstallDismissed', 'true');
    });

    // Detect if app is installed
    window.addEventListener('appinstalled', () => {
      console.log('PWA installed successfully');
      deferredPrompt = null;
    });

    // Check if running as PWA
    if (window.matchMedia('(display-mode: standalone)').matches) {
      console.log('Running as installed PWA');
    }
  </script>
</body>
</html>
